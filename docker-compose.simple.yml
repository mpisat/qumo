# Simple Docker Compose - Just Worksâ„¢
#
# Usage: docker-compose -f docker-compose.simple.yml up -d
#
# No config files or certificates needed - perfect for quick testing!

version: '3.8'

services:
  # SDN Controller - Just add and use
  qumo-sdn:
    image: ghcr.io/okdaichi/qumo:latest
    container_name: qumo-sdn
    ports:
      - "8090:8090"
    environment:
      - SDN_ADDR=:8090
      - DATA_DIR=/data
    volumes:
      - qumo-data:/data
    healthcheck:
      test: ["CMD", "wget", "-q", "-O", "-", "http://localhost:8090/graph"]
      interval: 10s
      timeout: 3s
      retries: 3
    restart: unless-stopped

  # Relay Server - Just add and use
  qumo-relay:
    image: ghcr.io/okdaichi/qumo:latest
    container_name: qumo-relay
    ports:
      - "4433:4433/udp"  # MoQT (QUIC)
      - "8080:8080"      # Health/Metrics
    environment:
      - RELAY_ADDR=0.0.0.0:4433
      - HEALTH_ADDR=:8080
      - INSECURE=true    # Skip TLS for development
      - SDN_URL=http://qumo-sdn:8090
    depends_on:
      qumo-sdn:
        condition: service_healthy
    healthcheck:
      test: ["CMD", "wget", "-q", "-O", "-", "http://localhost:8080/health"]
      interval: 10s
      timeout: 3s
      retries: 3
    restart: unless-stopped

volumes:
  qumo-data:

# Integration example with your app:
#
#   services:
#     your-app:
#       image: your-app:latest
#       # ... your config ...
#     
#     qumo-relay:
#       image: ghcr.io/okdaichi/qumo:latest
#       ports:
#         - "4433:4433/udp"
#         - "8080:8080"
#       environment:
#         - INSECURE=true
#
# That's it! No config files, no certificates needed.
